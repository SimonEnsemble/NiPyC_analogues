
# --------------------------------- Initialization -------------------------------------- #
units           real
atom_style      full
boundary        p p p

pair_style      lj/cut 14.000
bond_style      harmonic
angle_style     cosine/periodic
dihedral_style  harmonic
improper_style  fourier

special_bonds   lj/coul 0.0 0.0 1.0
pair_modify     tail no mix arithmetic
#dielectric      1.0
box tilt        large
read_data       data.NiPyC2_experiment_with_Xe
  triclinic box = (0 0 0) to (31.264 37.5702 30.8228) with tilt (0 -0.682783 0)
  1 by 1 by 1 MPI processor grid
  reading atoms ...
  2431 atoms
  scanning bonds ...
  6 = max bonds/atom
  scanning angles ...
  15 = max angles/atom
  scanning dihedrals ...
  8 = max dihedrals/atom
  scanning impropers ...
  3 = max impropers/atom
  reading bonds ...
  2880 bonds
  reading angles ...
  5490 angles
  reading dihedrals ...
  5760 dihedrals
  reading impropers ...
  3780 impropers
  6 = max # of 1-2 neighbors
  9 = max # of 1-3 neighbors
  12 = max # of special neighbors
  special bonds CPU = 0.00084075 secs
  read_data CPU = 0.0479437 secs

#### Atom Groupings ####
group           xe       id   2431   # 55
1 atoms in group xe
group           fram     id   1:2430 # 1:54 56:2431
2430 atoms in group fram
#### END Atom Groupings ####

###
# Speed up Calculations by exluding framework-framework interactions
#   since we are keeping the framework rigid and stationary
#
# neigh_modify keyword values ...
# keyword = exclude
# values  = group group1-ID group2-ID
#
# group1-ID, group2-ID = exclude if one atom is in 1st group, other in 2nd
###
neigh_modify exclude group fram fram

# ----------------------------- Variables ---------------------- #
dump            NiPyC2_experiment_with_Xe_xyzmov all xyz 5000 NiPyC2_experiment_with_Xe_mov.xyz
dump_modify     NiPyC2_experiment_with_Xe_xyzmov element Ni O N C H Xe
variable        dt         equal 1.00
variable        tdamp      equal 100*${dt}
variable        tdamp      equal 100*1
variable        eqtemp     equal 298.00

# ------------------------------ Equilibriation -------------------------------------------- #
# we do not need to perform equilibriation since we are using a rigid framework
# and the (single) adsorbate has already been inserted into the material via GCMC
# which already included an equilibriation phase.
#fix             1 xe langevin ${eqtemp} ${eqtemp} ${tdamp} 8646
#fix             2 xe nve
#fix             3 fram langevin 298.00 298.00 ${tdamp} 965287
#fix             4 fram nve
#thermo          0
#run             50000
#unfix           1
#unfix           2
#unfix           3
#unfix           4

# --------------------- Production (data gathering) --------------------------------------- #
# A simple way to hold atoms stationary is to not include those atoms in your time integration.
#reset_timestep  0

fix             3 xe nvt temp ${eqtemp} ${eqtemp} ${tdamp}
fix             3 xe nvt temp 298 ${eqtemp} ${tdamp}
fix             3 xe nvt temp 298 298 ${tdamp}
fix             3 xe nvt temp 298 298 100
#fix             4 fram rigid/nvt group 1 fram temp ${eqtemp} ${eqtemp} ${tdamp} # hold MOF atoms fixed
#fix             6 fram nvt temp 298.00 298.00 ${tdamp}

###
#  mean-squared disp of grp 1
#
# A vector of four quantities is calculated by this compute:
# The first 3 elements of the vector are the squared dx,dy,dz displacements, summed and averaged over atoms in the group.
# The fourth element is the total squared displacement, i.e. (dx*dx + dy*dy + dz*dz),
#  summed and averaged over atoms in the group.
#
# The displacement of an atom is from its reference position.
# This is normally the original position at the time the compute command was issued, unless the average keyword is set to yes.
# The value of the displacement will be 0.0 for atoms not in the specified compute group.
# The slope of the MSD versus time is proportional to the diffusion coefficient.
#
# MSD values can be accumulated in a vector via the fix vector command,
#   and a line fit to the vector to compute its slope via the variable slope function,
#   and thus extract D.
#
# fix ID group-ID vector Nevery value1 value2 ...
#
# c_ID[I] = Ith component of global vector calculated by a compute with ID
# f_ID = global scalar calculated by a fix with ID
# v_name = value calculated by an equal-style variable with name
#
# variable name style args...
#
# The slope() function uses linear regression to fit a line to the set of points,
#   equally spaced by 1 in their x coordinate: (1,V1), (2,V2), â€¦, (N,VN),
#   where the Vi are the values in the global vector of length N.
#   The returned value is the slope of the line.
#   If the line has a single point or is vertical, it returns 1.0e20.
###
compute         msd all msd com yes
#variable        twopoint equal c_msd[4]/6/(step*dt+1.0e-6) # scaled r_sqr(t)... not used? idk what this is for...
fix             5 xe vector 5 c_msd[4]
variable        fitslope equal slope(f_5)/6/(5*dt) # why dividing slope?

thermo_style    custom step v_eqtemp c_msd[4] v_fitslope # prints this info to log file

thermo          2000
run             500000
Neighbor list info ...
  update every 1 steps, delay 10 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 16
  ghost atom cutoff = 16
  binsize = 8, bins = 4 5 4
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/newton/tri
      stencil: half/bin/3d/newton/tri
      bin: standard
WARNING: Inconsistent image flags (src/domain.cpp:785)
Per MPI rank memory allocation (min/avg/max) = 31.83 | 31.83 | 31.83 Mbytes
Step v_eqtemp c_msd[4] v_fitslope 
       0          298 7.7461533e-30 3.3333333e+18 
    2000          298 0.0013454554 1.3367654e-07 
    4000          298 0.00035225219 3.3884044e-08 
    6000          298 0.00051199742 -1.3381158e-08 
    8000          298 0.00047428969 4.1443379e-11 
   10000          298 0.00012640708 -6.5029774e-09 
   12000          298 0.0011314854 -3.6262981e-09 
   14000          298 0.00035699575 -1.9811172e-09 
   16000          298 0.00073641338 -1.7844477e-09 
   18000          298 0.0003487785 -2.709814e-10 
   20000          298 0.00041951592 -1.2517222e-09 
   22000          298 0.00035729129 5.2515953e-11 
   24000          298 0.00018219201 -1.3038224e-09 
   26000          298 0.00080298002 -4.4224201e-10 
   28000          298 0.00012164326 -8.3596911e-10 
   30000          298 0.00070847665 -1.0260037e-09 
   32000          298 0.0003100455 -4.8214351e-10 
   34000          298 0.00015561856 -1.014841e-09 
   36000          298 0.00079794483 -6.5614206e-10 
   38000          298 0.00018792044 -7.0736996e-10 
   40000          298 0.00038515048 -9.3749602e-10 
   42000          298 0.00027389452 -4.867389e-10 
   44000          298 0.00012946681 -7.8170087e-10 
   46000          298 0.00062652509 -5.0387184e-10 
   48000          298 0.00017916602 -6.646625e-10 
   50000          298 0.0011751652 -5.3689959e-10 
   52000          298 0.00013172909 -5.0967432e-10 
   54000          298 0.00050776851 -5.8399194e-10 
   56000          298 0.0002756923 -3.2435593e-10 
   58000          298 0.00060974612 -4.7985309e-10 
   60000          298 0.0013089188 -1.0955869e-10 
   62000          298 1.0587131e-05 -1.134516e-10 
   64000          298 0.0012196068 -5.0323292e-11 
   66000          298 0.00036014703 1.1497616e-10 
   68000          298 0.00089056749 1.9650438e-11 
   70000          298 0.0005853183 7.8654351e-11 
   72000          298 0.00026445332 -4.159088e-11 
   74000          298 0.0013233668 9.5658065e-11 
   76000          298 0.00012233397 1.6877077e-10 
   78000          298 0.0010085741 7.7985683e-11 
   80000          298 0.00050151326 1.7667175e-10 
   82000          298 0.00025659141 1.3898104e-10 
   84000          298 0.0006236665 2.6591002e-10 
   86000          298 0.00090886267 2.1618287e-10 
   88000          298 0.00062707312 3.6790265e-10 
   90000          298 0.00037443836 2.830228e-10 
   92000          298 0.00064284425 2.8924829e-10 
   94000          298 0.0001546216 2.5705494e-10 
   96000          298 0.0013813013 2.5456628e-10 
   98000          298 0.00016196743 3.3452881e-10 
  100000          298 0.0010725739 2.6157454e-10 
  102000          298 0.00067682352 3.851619e-10 
  104000          298 8.3808183e-05 3.077319e-10 
  106000          298 0.0005539745 3.3412266e-10 
  108000          298 0.00076763515 3.0258689e-10 
  110000          298 0.00016153566 3.1886426e-10 
  112000          298 0.00095506444 2.7103697e-10 
  114000          298 0.00043239464 2.7647586e-10 
  116000          298 0.0013810647 2.8463742e-10 
  118000          298 0.00018178279 2.4909809e-10 
  120000          298 0.00081950816 2.3892106e-10 
  122000          298 0.00025200119 2.6001146e-10 
  124000          298 0.00073025251 2.0007965e-10 
  126000          298 0.00093790932 2.0765369e-10 
  128000          298 0.00023840206 1.8387026e-10 
  130000          298 0.0006687871 1.9765879e-10 
  132000          298 0.0010264614 2.078781e-10 
  134000          298 0.00044642847 2.0850246e-10 
  136000          298 0.00056917857 2.2053838e-10 
  138000          298 0.0013892327 2.0205825e-10 
  140000          298 0.00034366206 2.3016931e-10 
  142000          298 0.0013418694 2.4786201e-10 
  144000          298 0.00018917675 2.5517548e-10 
  146000          298 0.00062691995 2.2221504e-10 
  148000          298 0.00036897815 2.3315223e-10 
  150000          298 0.00028966816 1.8686858e-10 
  152000          298 0.0016747487 2.2581553e-10 
  154000          298 3.0030574e-05 2.1508352e-10 
  156000          298 0.00068884334 1.8489984e-10 
  158000          298 0.00082047524 1.7739461e-10 
  160000          298 0.00052798363 1.6085963e-10 
  162000          298 0.00014014594 1.2662013e-10 
  164000          298 0.0013715715 1.3780414e-10 
  166000          298 5.5606545e-05 1.4686362e-10 
  168000          298 0.0012655703 1.2853449e-10 
  170000          298 0.00073865505 1.5708785e-10 
  172000          298 0.00012992957 1.2982129e-10 
  174000          298 0.00041867123 1.4120256e-10 
  176000          298 0.00092387473 1.3328528e-10 
  178000          298 0.00069249752 1.6020227e-10 
  180000          298 0.00033196164 1.4218276e-10 
  182000          298 0.00029970514 1.4811891e-10 
  184000          298 0.00053446909 1.2003807e-10 
  186000          298 0.00047255757 1.2307968e-10 
  188000          298 0.0009824961 1.3271095e-10 
  190000          298 0.00081615911  1.31529e-10 
  192000          298 0.00021624874 1.2940332e-10 
  194000          298 0.00083512603 1.3851092e-10 
  196000          298 0.00056166408 1.354604e-10 
  198000          298 0.0011158844 1.2599216e-10 
  200000          298 0.00023433091 1.3852812e-10 
  202000          298 0.0011082185 1.3822892e-10 
  204000          298 0.00015924473 1.3219684e-10 
  206000          298 0.00077852527 1.2022708e-10 
  208000          298 0.0005408822 1.2479594e-10 
  210000          298 0.00056405333 1.1465785e-10 
  212000          298 0.00021554126 9.7395664e-11 
  214000          298 0.00064559154 1.1049168e-10 
  216000          298 0.00061971975 1.0202275e-10 
  218000          298 8.8564503e-05 9.5126305e-11 
  220000          298 0.00062451484 8.4455065e-11 
  222000          298 0.00059342687 8.6403684e-11 
  224000          298 0.00085050633 7.622027e-11 
  226000          298 0.0009765328 9.6983916e-11 
  228000          298 8.3167618e-05 8.0853738e-11 
  230000          298 0.0013499018 8.8646847e-11 
  232000          298 0.00014290494 9.6882026e-11 
  234000          298 0.0011767695 1.0387859e-10 
  236000          298 0.00035142962 1.4237695e-10 
  238000          298 0.0010030828 2.0473723e-10 
  240000          298 0.00018199452 3.5542451e-10 
  242000          298 0.0015329322 1.2320097e-09 
  244000          298 0.00015882196 -7.7811931e-10 
  246000          298 0.00077152276 -2.6943066e-10 
  248000          298 0.0003144303 -1.8479761e-10 
  250000          298 0.00014239849 -1.0575148e-10 
  252000          298 0.00071325413 -8.566386e-11 
  254000          298 0.0004353478 -6.213204e-11 
  256000          298 0.00081424412 -5.49356e-11 
  258000          298 0.00043306982 -4.8980518e-11 
  260000          298 0.00088201854 -4.021139e-11 
  262000          298 4.7269948e-05 -3.4990614e-11 
  264000          298 0.00099765051 -2.5341779e-11 
  266000          298 0.00046464873 -3.8577025e-11 
  268000          298 0.00022268177 -2.7015642e-11 
  270000          298 0.00095227958 -2.6564257e-11 
  272000          298 0.00011762229 -2.2808605e-11 
  274000          298 0.00089115607 -1.750097e-11 
  276000          298 0.00065091391 -2.7784261e-11 
  278000          298 0.00035895981 -2.0930326e-11 
  280000          298 0.00072852819 -2.0929651e-11 
  282000          298 0.00044953375 -1.9462323e-11 
  284000          298 0.00087732351 -1.8776024e-11 
  286000          298 4.2608527e-05 -1.6321129e-11 
  288000          298 0.00093679141 -1.2847691e-11 
  290000          298 0.00082765546 -2.0388365e-11 
  292000          298 0.00047879393 -1.7116733e-11 
  294000          298 0.00033685574 -1.7122784e-11 
  296000          298 0.00039492958 -1.4555281e-11 
  298000          298 0.00082973842 -1.5325096e-11 
  300000          298 8.4817342e-05 -1.3546917e-11 
  302000          298 0.00070191527 -1.0083838e-11 
  304000          298 0.00071447711 -1.3810819e-11 
  306000          298 0.00022195583 -1.1548217e-11 
  308000          298 0.00067228788 -9.7063414e-12 
  310000          298 0.0005110597 -1.0407377e-11 
  312000          298 0.0008073154 -7.8987217e-12 
  314000          298 0.00059738429 -1.3543063e-11 
  316000          298 0.00049902048 -1.0134781e-11 
  318000          298 0.00098510335 -1.4269499e-11 
  320000          298 0.00022002464 -1.3589131e-11 
  322000          298 0.0011400101 -1.1908904e-11 
  324000          298 0.00029223266 -1.3010946e-11 
  326000          298 0.00022566103 -9.8077592e-12 
  328000          298 0.00098845316 -1.0663431e-11 
  330000          298 0.00025106547 -1.0083143e-11 
  332000          298 0.00087965274 -1.282903e-11 
  334000          298 0.00052745201 -1.0851846e-11 
  336000          298 0.00044157602 -1.0505458e-11 
  338000          298 0.00048671545 -1.1315282e-11 
  340000          298 0.00054508498 -1.1269694e-11 
  342000          298 0.00036841122 -9.8385592e-12 
  344000          298 0.00037946434 -1.1113329e-11 
  346000          298 0.00021743876 -7.8587999e-12 
  348000          298 0.0014927938 -1.025214e-11 
  350000          298 7.1761038e-05 -1.1154521e-11 
  352000          298 0.00054458609 -9.3937155e-12 
  354000          298 0.00053154453 -9.5414611e-12 
  356000          298 0.00038152333 -7.8362885e-12 
  358000          298 0.00098904371 -8.4105298e-12 
  360000          298 0.00015584174 -6.425939e-12 
  362000          298 0.00054660202 -6.3226967e-12 
  364000          298 0.00023443704 -6.6041585e-12 
  366000          298 0.0012329856 -6.1640184e-12 
  368000          298 0.0004465303 -8.9155928e-12 
  370000          298 0.00056380483 -6.4419997e-12 
  372000          298 0.00090769983 -9.1989094e-12 
  374000          298 0.00010360248 -8.6478977e-12 
  376000          298 0.0010854953 -7.8278901e-12 
  378000          298 0.00015683788 -8.0412752e-12 
  380000          298 0.00067406256 -5.7366289e-12 
  382000          298 0.0001942116 -7.09602e-12 
  384000          298 0.00045402497 -5.04225e-12 
  386000          298 0.00045057457 -6.8290838e-12 
  388000          298 0.00032521187 -4.6423361e-12 
  390000          298 0.0010569392 -5.1914718e-12 
  392000          298 0.00023250959 -6.7237617e-12 
  394000          298 0.00097793513 -4.9649368e-12 
  396000          298 0.00092273443 -8.134287e-12 
  398000          298 0.00090291762 -7.2195373e-12 
  400000          298 0.00040134881 -8.9702702e-12 
  402000          298 0.00050083765 -8.8599066e-12 
  404000          298 0.00098925316 -1.0661224e-11 
  406000          298 0.00010111547 -9.395407e-12 
  408000          298 0.0012498464 -8.7970498e-12 
  410000          298 0.00019271546 7.7758297e-12 
  412000          298 0.0011458654 8.7252052e-12 
  414000          298 0.00045746008 1.0404548e-11 
  416000          298 0.00091072401 9.7805557e-12 
  418000          298 0.00054603714 1.0115399e-11 
  420000          298 0.00058513709 9.0183038e-12 
  422000          298 0.00057593937 8.6208904e-12 
  424000          298 0.00068907967 9.2550997e-12 
  426000          298 0.00070824376 1.0644429e-11 
  428000          298 0.00046417741 1.1333092e-11 
  430000          298 0.00055972512 1.2496165e-11 
  432000          298 0.00024590943 1.1769974e-11 
  434000          298 0.00039123721 8.8128185e-12 
  436000          298 0.0010358938 1.284344e-11 
  438000          298 0.00022081282 1.263742e-11 
  440000          298 0.00061130148 1.8329245e-11 
  442000          298  0.000917051 1.7926494e-11 
  444000          298 0.00085215292 2.7000068e-11 
  446000          298 4.5865675e-05 2.6133676e-11 
  448000          298 0.00081108019 2.9612502e-11 
  450000          298 0.00081891169 3.0283145e-11 
  452000          298 0.0010342441 4.5318707e-11 
  454000          298 0.00018825379 4.8927203e-11 
  456000          298 0.00057021921 5.8395817e-11 
  458000          298 0.00045574206 5.6624182e-11 
  460000          298 0.00061921094 6.9942456e-11 
  462000          298 0.00059504225 9.2337244e-11 
  464000          298 0.00040411105 1.0732295e-10 
  466000          298 0.00075619168 1.5504156e-10 
  468000          298 0.00013372797 2.3724283e-10 
  470000          298 0.0017300983 7.5653846e-10 
  472000          298 4.4144421e-05 -9.2364323e-10 
  474000          298 0.00093135343 -2.550269e-10 
  476000          298 0.00067920392 -1.9914942e-10 
  478000          298 0.00013786688 -1.2296077e-10 
  480000          298 0.00087104802 -9.4701449e-11 
  482000          298 3.9083532e-05 -7.3731778e-11 
  484000          298 0.0010769902 -6.0337404e-11 
  486000          298 0.00064478918 -6.7978081e-11 
  488000          298 0.00060238681 -5.1993723e-11 
  490000          298 0.00070656309 -5.6084328e-11 
  492000          298 0.00084274007 -5.2785119e-11 
  494000          298 0.00096032682 -5.3174407e-11 
  496000          298 0.00064191138 -5.348109e-11 
  498000          298 0.0012727246 -4.8742269e-11 
  500000          298 2.8582827e-05 -4.6098795e-11 
Loop time of 430.933 on 1 procs for 500000 steps with 2431 atoms

Performance: 100.248 ns/day, 0.239 hours/ns, 1160.273 timesteps/s
100.0% CPU use with 1 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 9.303      | 9.303      | 9.303      |   0.0 |  2.16
Bond    | 362.59     | 362.59     | 362.59     |   0.0 | 84.14
Neigh   | 13.101     | 13.101     | 13.101     |   0.0 |  3.04
Comm    | 29.164     | 29.164     | 29.164     |   0.0 |  6.77
Output  | 0.33753    | 0.33753    | 0.33753    |   0.0 |  0.08
Modify  | 7.5746     | 7.5746     | 7.5746     |   0.0 |  1.76
Other   |            | 8.867      |            |       |  2.06

Nlocal:    2431 ave 2431 max 2431 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    16166 ave 16166 max 16166 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    1179 ave 1179 max 1179 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 1179
Ave neighs/atom = 0.484986
Ave special neighs/atom = 6.58988
Neighbor list builds = 192
Dangerous builds = 0
unfix           3
#unfix           4
unfix           5
undump          NiPyC2_experiment_with_Xe_xyzmov


### NOTE:
# These fixes are overkill if you simply want to hold a collection of atoms stationary.
# A simpler way to hold atoms stationary is to not include those atoms in your time integration.
#
# The force and torque keywords discussed next are only allowed for the rigid styles
# An xflag, yflag, or zflag set to off means turn off the component of force of torque in that dimension.
#  if you expect a rigid body not to move or rotate by using these keywords, you must insure its initial
# center-of-mass translational or angular velocity is 0.0.
# Otherwise the initial translational or angular momentum the body has will persist.
###
Total wall time: 0:07:11

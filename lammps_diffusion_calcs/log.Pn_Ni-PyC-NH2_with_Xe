
# --------------------------------- Initialization -------------------------------------- #
units           real
atom_style      full
boundary        p p p

pair_style      lj/cut 14.000
bond_style      harmonic
angle_style     cosine/periodic
dihedral_style  harmonic
improper_style  fourier

special_bonds   lj/coul 0.0 0.0 1.0
#dielectric      1.0
pair_modify     tail yes mix arithmetic
box tilt        large
read_data       data.Pn_Ni-PyC-NH2_with_Xe
  triclinic box = (0 0 0) to (31.854 35.6358 28.3672) with tilt (0 0.013863 0)
  1 by 1 by 1 MPI processor grid
  reading atoms ...
  2233 atoms
  scanning bonds ...
  6 = max bonds/atom
  scanning angles ...
  15 = max angles/atom
  scanning dihedrals ...
  12 = max dihedrals/atom
  scanning impropers ...
  3 = max impropers/atom
  reading bonds ...
  2592 bonds
  reading angles ...
  4824 angles
  reading dihedrals ...
  5184 dihedrals
  reading impropers ...
  3456 impropers
  6 = max # of 1-2 neighbors
  9 = max # of 1-3 neighbors
  12 = max # of special neighbors
  special bonds CPU = 0.00074434 secs
  read_data CPU = 0.045081 secs

#### Atom Groupings ####
group           xe       id   63
1 atoms in group xe
group           fram     id   1:62 64:2233
2232 atoms in group fram
#### END Atom Groupings ####

###
# Speed up Calculations by exluding framework-framework interactions
#   since we are keeping the framework rigid and stationary
#
# neigh_modify keyword values ...
# keyword = exclude
# values  = group group1-ID group2-ID
#
# group1-ID, group2-ID = exclude if one atom is in 1st group, other in 2nd
###
neigh_modify exclude group fram fram

# ----------------------------- Variables ---------------------- #
dump            Pn_Ni-PyC-NH2_with_Xe_xyzmov all xyz 5000 Pn_Ni-PyC-NH2_with_Xe_mov.xyz
dump_modify     Pn_Ni-PyC-NH2_with_Xe_xyzmov element Ni O C H N Xe
variable        dt         equal 1.00
variable        tdamp      equal 100*${dt}
variable        tdamp      equal 100*1
variable        eqtemp     equal 298.00

# ------------------------------ Equilibriation -------------------------------------------- #
# we do not need to perform equilibriation since we are using a rigid framework
# and the (single) adsorbate has already been inserted into the material via GCMC
# which already included an equilibriation phase.
#fix             1 1 langevin 298.00 298.00 ${tdamp} 1305871
#fix             2 1 nve
#fix             3 fram langevin 298.00 298.00 ${tdamp} 1500201
#fix             4 fram nve
#thermo          0
#run             200000
#unfix           1
#unfix           2
#unfix           3
#unfix           4

# --------------------- Production (data gathering) --------------------------------------- #
# A simple way to hold atoms stationary is to not include those atoms in your time integration.
#reset_timestep  0

fix             1 xe nvt temp 298.00 298.00 ${tdamp}
fix             1 xe nvt temp 298.00 298.00 100
#fix             6 fram nvt temp 298.00 298.00 ${tdamp}


###
#  mean-squared disp of grp 1
#
# A vector of four quantities is calculated by this compute:
# The first 3 elements of the vector are the squared dx,dy,dz displacements, summed and averaged over atoms in the group.
# The fourth element is the total squared displacement, i.e. (dx*dx + dy*dy + dz*dz),
#  summed and averaged over atoms in the group.
#
# The slope of the MSD versus time is proportional to the diffusion coefficient.
# MSD values can be accumulated in a vector via the fix vector command,
#   and a line fit to the vector to compute its slope via the variable slope function,
#   and thus extract D.
#
# fix ID group-ID vector Nevery value1 value2 ...
#
# c_ID[I] = Ith component of global vector calculated by a compute with ID
# f_ID = global scalar calculated by a fix with ID
# v_name = value calculated by an equal-style variable with name
#
# variable name style args...
#
# The slope() function uses linear regression to fit a line to the set of points,
#   equally spaced by 1 in their x coordinate: (1,V1), (2,V2), â€¦, (N,VN),
#   where the Vi are the values in the global vector of length N.
#   The returned value is the slope of the line.
#   If the line has a single point or is vertical, it returns 1.0e20.
###
compute         msd all msd com yes
#variable        twopoint equal c_msd[4]/6/(step*dt+1.0e-6) # scaled r_sqr(t)... not used? idk what this is for...
fix             2 xe vector 5 c_msd[4]
variable        fitslope equal slope(f_2)/6/(5*dt) # why dividing slope?

thermo_style    custom step v_eqtemp c_msd[4] v_fitslope # prints this info to log file



thermo          5000
run             200000
Neighbor list info ...
  update every 1 steps, delay 10 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 16
  ghost atom cutoff = 16
  binsize = 8, bins = 4 5 4
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/newton/tri
      stencil: half/bin/3d/newton/tri
      bin: standard
WARNING: Inconsistent image flags (src/domain.cpp:785)
Per MPI rank memory allocation (min/avg/max) = 34.26 | 34.26 | 34.26 Mbytes
Step v_eqtemp c_msd[4] v_fitslope 
       0          298 6.3790691e-30 3.3333333e+18 
    5000          298 0.0030049628 1.8423826e-08 
   10000          298 0.00037934353 -1.2320242e-09 
   15000          298 0.0022899871 2.3003198e-09 
   20000          298 9.7933843e-05 -7.1455049e-10 
   25000          298 0.0014225614 1.483745e-10 
   30000          298 0.00037964406 4.3783798e-10 
   35000          298 0.0013722992 3.0912613e-10 
   40000          298 0.00072535221 2.0604398e-10 
   45000          298 0.00090907013 -5.5876302e-10 
   50000          298  0.000531637 -5.7774039e-10 
   55000          298 0.0012085471 -4.3789852e-10 
   60000          298 0.0010433202 -4.0186111e-10 
   65000          298 0.0010419251 -5.3530155e-10 
   70000          298 0.00036011453 -5.3136208e-10 
   75000          298  0.001244179 -2.2646798e-10 
   80000          298 0.0010586691 -4.7790031e-12 
   85000          298 0.00057148775 -8.3096538e-11 
   90000          298 0.00070060454 -1.1402605e-10 
   95000          298 0.00077761808 -7.1752368e-11 
  100000          298 0.00063639407 -1.0516468e-10 
  105000          298 0.0011401818 -1.0544191e-10 
  110000          298 0.00074841215 -1.0428647e-10 
  115000          298 0.00016610913 -7.4937466e-11 
  120000          298  0.002767063 -3.3063617e-11 
  125000          298 0.00058374344 2.7027837e-11 
  130000          298 0.00066295357 -2.6385452e-12 
  135000          298 0.0011673999 -2.7392011e-11 
  140000          298 0.00038869592 -6.1330407e-11 
  145000          298 0.00029194719 -2.8605369e-11 
  150000          298 0.00065909515 1.2000868e-11 
  155000          298 0.0005702779 -1.6634517e-11 
  160000          298 0.0011100841 1.4808352e-10 
  165000          298 0.0021458425 7.0502229e-11 
  170000          298 0.0010141692 1.1091371e-10 
  175000          298 0.00073571957 1.0905986e-10 
  180000          298 0.00050314879 7.4098546e-11 
  185000          298 0.0015551252 2.2445309e-11 
  190000          298 0.00094817705 1.7643483e-11 
  195000          298  0.002918479 5.5773474e-11 
  200000          298  0.001367437 6.3902768e-11 
Loop time of 170.804 on 1 procs for 200000 steps with 2233 atoms

Performance: 101.169 ns/day, 0.237 hours/ns, 1170.932 timesteps/s
100.0% CPU use with 1 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 3.5754     | 3.5754     | 3.5754     |   0.0 |  2.09
Bond    | 126.97     | 126.97     | 126.97     |   0.0 | 74.33
Neigh   | 23.193     | 23.193     | 23.193     |   0.0 | 13.58
Comm    | 10.971     | 10.971     | 10.971     |   0.0 |  6.42
Output  | 0.10272    | 0.10272    | 0.10272    |   0.0 |  0.06
Modify  | 2.7224     | 2.7224     | 2.7224     |   0.0 |  1.59
Other   |            | 3.273      |            |       |  1.92

Nlocal:    2233 ave 2233 max 2233 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    15409 ave 15409 max 15409 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    1199 ave 1199 max 1199 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 1199
Ave neighs/atom = 0.536946
Ave special neighs/atom = 6.38424
Neighbor list builds = 438
Dangerous builds = 0
unfix           1
unfix           2
undump          Pn_Ni-PyC-NH2_with_Xe_xyzmov


Total wall time: 0:02:50

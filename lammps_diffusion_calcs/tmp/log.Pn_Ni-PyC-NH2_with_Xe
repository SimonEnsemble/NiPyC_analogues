
# --------------------------------- Initialization -------------------------------------- #
units           real
atom_style      full
boundary        p p p

pair_style      lj/cut 14.000
bond_style      harmonic
angle_style     cosine/periodic
dihedral_style  harmonic
improper_style  fourier

special_bonds   lj/coul 0.0 0.0 1.0
#dielectric      1.0
pair_modify     tail yes mix arithmetic
box tilt        large
read_data       data.Pn_Ni-PyC-NH2_with_Xe
  triclinic box = (0 0 0) to (31.854 35.6358 28.3672) with tilt (0 0.013863 0)
  1 by 1 by 1 MPI processor grid
  reading atoms ...
  2233 atoms
  scanning bonds ...
  6 = max bonds/atom
  scanning angles ...
  15 = max angles/atom
  scanning dihedrals ...
  12 = max dihedrals/atom
  scanning impropers ...
  3 = max impropers/atom
  reading bonds ...
  2592 bonds
  reading angles ...
  4824 angles
  reading dihedrals ...
  5184 dihedrals
  reading impropers ...
  3456 impropers
  6 = max # of 1-2 neighbors
  9 = max # of 1-3 neighbors
  12 = max # of special neighbors
  special bonds CPU = 0.000844024 secs
  read_data CPU = 0.0473843 secs

#### Atom Groupings ####
group           xe       id   2233   # 63
1 atoms in group xe
group           fram     id   1:2232 # 1:62 64:2233
2232 atoms in group fram
#### END Atom Groupings ####

###
# Speed up Calculations by exluding framework-framework interactions
#   since we are keeping the framework rigid and stationary
#
# neigh_modify keyword values ...
# keyword = exclude
# values  = group group1-ID group2-ID
#
# group1-ID, group2-ID = exclude if one atom is in 1st group, other in 2nd
###
neigh_modify exclude group fram fram

# ----------------------------- Variables ---------------------- #
dump            Pn_Ni-PyC-NH2_with_Xe_xyzmov all xyz 5000 Pn_Ni-PyC-NH2_with_Xe_mov.xyz
dump_modify     Pn_Ni-PyC-NH2_with_Xe_xyzmov element Ni O C H N Xe
variable        dt         equal 1.00
variable        tdamp      equal 100*${dt}
variable        tdamp      equal 100*1
variable        eqtemp     equal 298.00

# ------------------------------ Equilibriation -------------------------------------------- #
# we do not need to perform equilibriation since we are using a rigid framework
# and the (single) adsorbate has already been inserted into the material via GCMC
# which already included an equilibriation phase.
#fix             1 1 langevin 298.00 298.00 ${tdamp} 1305871
#fix             2 1 nve
#fix             3 fram langevin 298.00 298.00 ${tdamp} 1500201
#fix             4 fram nve
#thermo          0
#run             200000
#unfix           1
#unfix           2
#unfix           3
#unfix           4

# --------------------- Production (data gathering) --------------------------------------- #
# A simple way to hold atoms stationary is to not include those atoms in your time integration.
#reset_timestep  0

fix             1 xe nvt temp 298.00 298.00 ${tdamp}
fix             1 xe nvt temp 298.00 298.00 100
#fix             6 fram nvt temp 298.00 298.00 ${tdamp}


###
#  mean-squared disp of grp 1
#
# A vector of four quantities is calculated by this compute:
# The first 3 elements of the vector are the squared dx,dy,dz displacements, summed and averaged over atoms in the group.
# The fourth element is the total squared displacement, i.e. (dx*dx + dy*dy + dz*dz),
#  summed and averaged over atoms in the group.
#
# The slope of the MSD versus time is proportional to the diffusion coefficient.
# MSD values can be accumulated in a vector via the fix vector command,
#   and a line fit to the vector to compute its slope via the variable slope function,
#   and thus extract D.
#
# fix ID group-ID vector Nevery value1 value2 ...
#
# c_ID[I] = Ith component of global vector calculated by a compute with ID
# f_ID = global scalar calculated by a fix with ID
# v_name = value calculated by an equal-style variable with name
#
# variable name style args...
#
# The slope() function uses linear regression to fit a line to the set of points,
#   equally spaced by 1 in their x coordinate: (1,V1), (2,V2), â€¦, (N,VN),
#   where the Vi are the values in the global vector of length N.
#   The returned value is the slope of the line.
#   If the line has a single point or is vertical, it returns 1.0e20.
###
compute         msd all msd com yes
#variable        twopoint equal c_msd[4]/6/(step*dt+1.0e-6) # scaled r_sqr(t)... not used? idk what this is for...
fix             2 xe vector 5 c_msd[4]
variable        fitslope equal slope(f_2)/6/(5*dt) # why dividing slope?

thermo_style    custom step v_eqtemp c_msd[4] v_fitslope # prints this info to log file



thermo          2000
run             500000
Neighbor list info ...
  update every 1 steps, delay 10 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 16
  ghost atom cutoff = 16
  binsize = 8, bins = 4 5 4
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/newton/tri
      stencil: half/bin/3d/newton/tri
      bin: standard
WARNING: Inconsistent image flags (src/domain.cpp:785)
Per MPI rank memory allocation (min/avg/max) = 34.26 | 34.26 | 34.26 Mbytes
Step v_eqtemp c_msd[4] v_fitslope 
       0          298 1.8817141e-29 3.3333333e+18 
    2000          298 0.00088341299 1.0279823e-07 
    4000          298 0.00090589377 3.6633854e-08 
    6000          298 0.00035878253 -4.6683018e-09 
    8000          298 0.0011182089 2.9111925e-09 
   10000          298 0.00022869036 4.1038985e-09 
   12000          298 0.0011613643 -1.7752493e-09 
   14000          298 0.00048659974 1.0150236e-09 
   16000          298 4.1281445e-05 -1.7023498e-09 
   18000          298 5.1886224e-05 -3.4375077e-09 
   20000          298 0.00091424181 -1.6781011e-09 
   22000          298 0.00048197252 -1.9851304e-09 
   24000          298 0.00097372952 -1.9403348e-09 
   26000          298 0.00041495402 -1.5186135e-10 
   28000          298 0.00036811731 -4.7067229e-10 
   30000          298 0.00027237196 -7.7061166e-10 
   32000          298 0.00076145737 -1.03527e-09 
   34000          298 0.0001503555 -5.7332401e-10 
   36000          298 0.00096415989 -5.7099401e-10 
   38000          298 0.0011195914 -4.3395971e-10 
   40000          298 0.00025134942 -1.7122402e-10 
   42000          298 0.00068421361 -2.6856875e-10 
   44000          298 0.00054009604 -2.3020162e-10 
   46000          298 0.00082744932 -2.9901448e-11 
   48000          298 0.00063948542 -2.025698e-10 
   50000          298 0.00043042953 -3.3866848e-11 
   52000          298 0.00097101637 -1.0068404e-10 
   54000          298 0.00091655138 -1.4798453e-10 
   56000          298 0.00021272725 1.4042914e-11 
   58000          298 0.00090954179 -8.1779912e-11 
   60000          298 2.7486213e-05 -1.5264655e-10 
   62000          298 0.00076828622 -2.2750577e-11 
   64000          298 0.00091171698 3.4220594e-11 
   66000          298 0.00084205619 -7.177193e-11 
   68000          298 0.00020273946 3.5518152e-11 
   70000          298 0.00024699041 7.1386846e-11 
   72000          298 0.00060612012 1.7285552e-10 
   74000          298 0.00099937504 8.3873053e-11 
   76000          298 0.0011101793 1.0219621e-10 
   78000          298 0.00028988384 1.7657652e-10 
   80000          298 0.00036372017 6.7856319e-11 
   82000          298 0.00081271826 8.5100168e-11 
   84000          298 0.00069793368 -5.2934349e-12 
   86000          298 0.00086267057 3.8350931e-11 
   88000          298 0.00083592365 2.573062e-11 
   90000          298 0.00048276485 1.2029332e-10 
   92000          298 0.00017627115 5.3416095e-11 
   94000          298 0.00095229656 -1.0064163e-11 
   96000          298 0.00013291523 -5.1916679e-11 
   98000          298 0.00046484238 -1.1023516e-10 
  100000          298 0.00076424628 -3.3534459e-11 
  102000          298 0.00020091683 -5.6763441e-11 
  104000          298 0.0012851898 -3.5531196e-11 
  106000          298 0.00079947171 -3.8976886e-11 
  108000          298 0.00052743967 -5.4009938e-11 
  110000          298 0.00065174539 -4.9327109e-12 
  112000          298 0.0010037611 -2.2456659e-11 
  114000          298 0.00037529135 -3.8601799e-11 
  116000          298 0.00029411971 -3.481549e-12 
  118000          298 0.00080890988 1.5131728e-11 
  120000          298 0.00061174237 -2.2589048e-11 
  122000          298 0.00024405594 -3.2641745e-11 
  124000          298 0.00021573427 -5.8449505e-11 
  126000          298 0.00070949227 -6.604549e-11 
  128000          298 0.00043635933 -9.2717467e-11 
  130000          298 0.00058785246 -1.0895913e-10 
  132000          298 0.00024361748 -8.3072611e-11 
  134000          298 0.00050324457 -9.197463e-11 
  136000          298 0.00067722563 -5.7433696e-11 
  138000          298 0.00061067939 -8.2908464e-11 
  140000          298 0.00066817746 -7.1231207e-11 
  142000          298 0.00041607086 -8.6337763e-11 
  144000          298 0.00060358987 -1.0515874e-10 
  146000          298 0.00080051636 -7.2537397e-11 
  148000          298 0.00078116996 -8.2635057e-11 
  150000          298 0.00028578497 -7.8192435e-11 
  152000          298 0.0014439312 -9.4273841e-11 
  154000          298 0.00029797605 -8.7572336e-11 
  156000          298 0.00068518793 -7.4085004e-11 
  158000          298 0.00091105795 -4.604102e-11 
  160000          298 0.00018246621 -5.0084166e-11 
  162000          298 0.0012532137 -3.8106677e-11 
  164000          298 0.00046542771 -3.4836767e-11 
  166000          298 0.00031810395 -5.817589e-11 
  168000          298 0.00044596016 -3.8522717e-11 
  170000          298 0.00026311546 -5.6396396e-11 
  172000          298 0.00034136638 -6.60281e-11 
  174000          298 0.00023811093 -8.27904e-11 
  176000          298 0.00087593565 -6.7840277e-11 
  178000          298 0.00090772571 -7.9690436e-11 
  180000          298 0.00026490006 -6.9849452e-11 
  182000          298 0.00067626897 -8.2401294e-11 
  184000          298 0.00011715759 -7.227812e-11 
  186000          298 0.00034830682 -8.3048564e-11 
  188000          298 0.00020681399 -8.4834157e-11 
  190000          298 6.7862322e-05 -9.8731368e-11 
  192000          298 0.00082763112 -9.1059706e-11 
  194000          298 0.00013816796 -9.111157e-11 
  196000          298 0.00071980781 -7.6952928e-11 
  198000          298 0.00059685975 -9.0707388e-11 
  200000          298 0.00038821687 -8.8095112e-11 
  202000          298 0.00025008333 -8.8719309e-11 
  204000          298 0.0010276859 -7.2522431e-11 
  206000          298 0.00051582455 -8.1978521e-11 
  208000          298 0.00051364477 -8.2831686e-11 
  210000          298 0.00055936418 -5.9899019e-11 
  212000          298 0.0005270025 -6.1564952e-11 
  214000          298 0.00037677031 -6.494898e-11 
  216000          298 0.00045816525 -6.6051303e-11 
  218000          298 0.00041208431 -5.7257957e-11 
  220000          298 0.00045491806 -6.5846482e-11 
  222000          298 0.00054889731 -4.9927092e-11 
  224000          298 0.00087129466 -5.5907115e-11 
  226000          298 0.00023169702 -5.7127821e-11 
  228000          298 0.00055916579 -5.9109096e-11 
  230000          298 0.00027067414 -6.2783111e-11 
  232000          298 0.00088358301 -6.2191258e-11 
  234000          298 0.00027442446 -8.0435513e-11 
  236000          298 0.00062699915 -7.8890714e-11 
  238000          298 0.00033910309 -1.2232011e-10 
  240000          298 0.00022149856 -2.3828206e-10 
  242000          298 0.00038909366 -9.4561512e-10 
  244000          298 0.00029530784 7.1894907e-10 
  246000          298 0.00071622769 2.2959042e-10 
  248000          298 0.00021596735 1.5368775e-10 
  250000          298 0.00026745118 1.3039431e-10 
  252000          298 0.00038376777 1.0309595e-10 
  254000          298 0.00065959235 9.4897578e-11 
  256000          298 0.00073654145 8.7719384e-11 
  258000          298 0.00045653714 6.7488939e-11 
  260000          298 0.00019245544 6.2112797e-11 
  262000          298 0.00098422588 5.3561845e-11 
  264000          298  0.001120957 4.0190189e-11 
  266000          298 0.00035017182 4.0923961e-11 
  268000          298 0.00055459509 4.0141461e-11 
  270000          298 0.00065688138 3.0097096e-11 
  272000          298 0.00034245624 3.1674525e-11 
  274000          298 0.0013333124 3.1237651e-11 
  276000          298 2.3856072e-05 2.8871995e-11 
  278000          298 0.00063315646 2.9397415e-11 
  280000          298 0.00044044081 2.1740009e-11 
  282000          298 0.00011969701 2.4015301e-11 
  284000          298 0.00093607099 2.2488931e-11 
  286000          298 0.00029009798 1.9685041e-11 
  288000          298 0.00018896034 2.206924e-11 
  290000          298 0.00052061191 2.1011169e-11 
  292000          298 0.00072006815 2.2134155e-11 
  294000          298 0.00038643177 2.1242102e-11 
  296000          298 0.00060762303 2.1888912e-11 
  298000          298 0.00046602402 1.5140939e-11 
  300000          298 0.00085628556 1.5947868e-11 
  302000          298 0.00043330219 1.6065196e-11 
  304000          298 0.0013243589 1.4588522e-11 
  306000          298 0.00016274787 1.4845981e-11 
  308000          298 0.00045805893 1.3471809e-11 
  310000          298 0.00018022858 1.4935347e-11 
  312000          298 0.00076967545 1.5080543e-11 
  314000          298 0.00061448577 1.5684226e-11 
  316000          298 8.2052088e-05 1.655202e-11 
  318000          298 0.00038971749 1.7197323e-11 
  320000          298 0.0010252353 1.4888983e-11 
  322000          298 0.00089714773 1.499248e-11 
  324000          298 0.00046768843 1.4005985e-11 
  326000          298 0.0012868622 1.050962e-11 
  328000          298 0.00090491397 9.7902576e-12 
  330000          298 0.0001446105 1.0078099e-11 
  332000          298 0.00066351762 8.184739e-12 
  334000          298 0.00051984679 7.5966097e-12 
  336000          298 0.0012768433 7.1126582e-12 
  338000          298 0.0011626065  7.57001e-12 
  340000          298 0.00053549705 7.5235818e-12 
  342000          298 0.00010669839 5.8883545e-12 
  344000          298 0.00013145325 7.6580798e-12 
  346000          298 0.00045329125 9.3915709e-12 
  348000          298 0.0012231555 8.9731511e-12 
  350000          298 0.00030956913 7.5216813e-12 
  352000          298 0.0002733374 9.1256396e-12 
  354000          298 0.00063072228 7.0539957e-12 
  356000          298 0.00088576747 7.9040793e-12 
  358000          298 0.00045614098 8.549734e-12 
  360000          298 0.00055410476 5.8346168e-12 
  362000          298 3.576495e-05 6.7971965e-12 
  364000          298 0.00058884245 8.2664842e-12 
  366000          298 0.00062513277 9.4166679e-12 
  368000          298 0.00088210924 7.027051e-12 
  370000          298 0.00025442705 5.7546104e-12 
  372000          298 0.00047244418 6.318535e-12 
  374000          298  0.001368101 5.4871363e-12 
  376000          298 0.00042094164 5.343134e-12 
  378000          298 0.00027957811 5.9067673e-12 
  380000          298 0.00077625502 4.7027528e-12 
  382000          298 0.00057304679 3.1622136e-12 
  384000          298 0.00092764528 3.0452932e-12 
  386000          298  0.001039009 2.123048e-12 
  388000          298 2.0103046e-05 2.3461879e-12 
  390000          298 0.00037889889 3.6616893e-12 
  392000          298 0.00070204412 2.322496e-12 
  394000          298 0.00057254597 3.9976805e-12 
  396000          298 0.00099652756 3.3941147e-12 
  398000          298 0.00032641884 3.0186412e-12 
  400000          298 0.00030601176 2.1273415e-12 
  402000          298 0.0011198338 1.6330252e-12 
  404000          298 0.0003692044 2.0176544e-12 
  406000          298 0.00087321168 2.3424069e-12 
  408000          298 0.00050765493 1.8312054e-12 
  410000          298 0.00071596387 -2.7436508e-12 
  412000          298 0.00045562101 -2.8895675e-12 
  414000          298 0.00043328782 -3.1727815e-12 
  416000          298 0.0003023796 -4.0962587e-12 
  418000          298 0.00044024551 -5.2268898e-12 
  420000          298 0.00039073471 -3.9565303e-12 
  422000          298 0.0008518093 -4.4020113e-12 
  424000          298 0.00051028667 -3.3207967e-12 
  426000          298 0.00091476453 -3.1037264e-12 
  428000          298 0.00057750474 -3.6035377e-12 
  430000          298 0.00025545604 -4.8588267e-12 
  432000          298 0.0011470506 -3.0462205e-12 
  434000          298   0.00109138 -4.1835255e-12 
  436000          298 0.00018716201 -2.7828645e-12 
  438000          298 0.00044652775 -6.0826586e-12 
  440000          298 0.00020988167 -3.5293013e-12 
  442000          298 0.0010047495 -2.1059484e-12 
  444000          298 0.00030263481 -4.637155e-12 
  446000          298 0.00060712965 -6.152623e-12 
  448000          298 0.00064435207 -7.5542786e-13 
  450000          298 0.00046538929 -2.519226e-12 
  452000          298 0.0011485619 -6.1376517e-12 
  454000          298 0.00036551049 -6.7193774e-13 
  456000          298 0.00022444988 -7.0825412e-12 
  458000          298 0.00070071346 -1.0326387e-12 
  460000          298 0.0010192722 -3.9288584e-12 
  462000          298 0.00047978253 -8.6334437e-12 
  464000          298 0.00088619559 1.9387111e-13 
  466000          298  0.001067643 -6.1414086e-12 
  468000          298 0.00044373489 -2.3079274e-11 
  470000          298 7.6132975e-05 9.8284663e-12 
  472000          298 0.00053015068 2.2585944e-11 
  474000          298 0.00041645172 2.4580292e-11 
  476000          298 0.00064874756 3.1456855e-11 
  478000          298 0.00019025985 1.6651828e-11 
  480000          298 0.0012550599 1.6623103e-11 
  482000          298 0.00049385958 1.4048297e-11 
  484000          298 0.00050752019 1.0187096e-11 
  486000          298 0.0014839579 -1.0386702e-12 
  488000          298 0.00048986576 -5.6764624e-12 
  490000          298 7.3335091e-05 -5.3273895e-12 
  492000          298 0.00066135577 -9.0109573e-12 
  494000          298 0.0010047463 -4.4100991e-12 
  496000          298 0.00036451271 -4.6766492e-12 
  498000          298 0.00061635781 -1.1823474e-11 
  500000          298 0.0011548086 -9.5277761e-12 
Loop time of 391.743 on 1 procs for 500000 steps with 2233 atoms

Performance: 110.276 ns/day, 0.218 hours/ns, 1276.346 timesteps/s
100.0% CPU use with 1 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 9.0934     | 9.0934     | 9.0934     |   0.0 |  2.32
Bond    | 320.72     | 320.72     | 320.72     |   0.0 | 81.87
Neigh   | 18.914     | 18.914     | 18.914     |   0.0 |  4.83
Comm    | 27.303     | 27.303     | 27.303     |   0.0 |  6.97
Output  | 0.30757    | 0.30757    | 0.30757    |   0.0 |  0.08
Modify  | 6.8651     | 6.8651     | 6.8651     |   0.0 |  1.75
Other   |            | 8.541      |            |       |  2.18

Nlocal:    2233 ave 2233 max 2233 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    15409 ave 15409 max 15409 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    1213 ave 1213 max 1213 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 1213
Ave neighs/atom = 0.543215
Ave special neighs/atom = 6.38424
Neighbor list builds = 353
Dangerous builds = 0
unfix           1
unfix           2
undump          Pn_Ni-PyC-NH2_with_Xe_xyzmov


Total wall time: 0:06:31


# --------------------------------- Initialization -------------------------------------- #
units           real
atom_style      full
boundary        p p p

pair_style      lj/cut 14.000
bond_style      harmonic
angle_style     cosine/periodic
dihedral_style  harmonic
improper_style  fourier

special_bonds   lj/coul 0.0 0.0 1.0
#dielectric      1.0
pair_modify     tail yes mix arithmetic
box tilt        large
read_data       data.Pn_Ni-PyC-NH2_with_Kr
  triclinic box = (0 0 0) to (31.854 35.6358 28.3672) with tilt (0 0.013863 0)
  1 by 1 by 1 MPI processor grid
  reading atoms ...
  2233 atoms
  scanning bonds ...
  6 = max bonds/atom
  scanning angles ...
  15 = max angles/atom
  scanning dihedrals ...
  12 = max dihedrals/atom
  scanning impropers ...
  3 = max impropers/atom
  reading bonds ...
  2592 bonds
  reading angles ...
  4824 angles
  reading dihedrals ...
  5184 dihedrals
  reading impropers ...
  3456 impropers
  6 = max # of 1-2 neighbors
  9 = max # of 1-3 neighbors
  12 = max # of special neighbors
  special bonds CPU = 0.000893322 secs
  read_data CPU = 0.0466349 secs

#### Atom Groupings ####
group           kr       id   2233   # 63
1 atoms in group kr
group           fram     id   1:2232 # 1:62 64:2233
2232 atoms in group fram
#### END Atom Groupings ####

###
# Speed up Calculations by exluding framework-framework interactions
#   since we are keeping the framework rigid and stationary
#
# neigh_modify keyword values ...
# keyword = exclude
# values  = group group1-ID group2-ID
#
# group1-ID, group2-ID = exclude if one atom is in 1st group, other in 2nd
###
neigh_modify exclude group fram fram

# ----------------------------- Variables ---------------------- #
dump            Pn_Ni-PyC-NH2_with_Kr_xyzmov all xyz 5000 Pn_Ni-PyC-NH2_with_Kr_mov.xyz
dump_modify     Pn_Ni-PyC-NH2_with_Kr_xyzmov element Ni O C H N Kr
variable        dt         equal 1.00
variable        tdamp      equal 100*${dt}
variable        tdamp      equal 100*1
variable        eqtemp     equal 298.00

# ------------------------------ Equilibriation -------------------------------------------- #
# we do not need to perform equilibriation since we are using a rigid framework
# and the (single) adsorbate has already been inserted into the material via GCMC
# which already included an equilibriation phase.
#fix             1 1 langevin 298.00 298.00 ${tdamp} 1305871
#fix             2 1 nve
#fix             3 fram langevin 298.00 298.00 ${tdamp} 1500201
#fix             4 fram nve
#thermo          0
#run             200000
#unfix           1
#unfix           2
#unfix           3
#unfix           4

# --------------------- Production (data gathering) --------------------------------------- #
# A simple way to hold atoms stationary is to not include those atoms in your time integration.
#reset_timestep  0

fix             1 kr nvt temp 298.00 298.00 ${tdamp}
fix             1 kr nvt temp 298.00 298.00 100
#fix             6 fram nvt temp 298.00 298.00 ${tdamp}


###
#  mean-squared disp of grp 1
#
# A vector of four quantities is calculated by this compute:
# The first 3 elements of the vector are the squared dx,dy,dz displacements, summed and averaged over atoms in the group.
# The fourth element is the total squared displacement, i.e. (dx*dx + dy*dy + dz*dz),
#  summed and averaged over atoms in the group.
#
# The slope of the MSD versus time is proportional to the diffusion coefficient.
# MSD values can be accumulated in a vector via the fix vector command,
#   and a line fit to the vector to compute its slope via the variable slope function,
#   and thus extract D.
#
# fix ID group-ID vector Nevery value1 value2 ...
#
# c_ID[I] = Ith component of global vector calculated by a compute with ID
# f_ID = global scalar calculated by a fix with ID
# v_name = value calculated by an equal-style variable with name
#
# variable name style args...
#
# The slope() function uses linear regression to fit a line to the set of points,
#   equally spaced by 1 in their x coordinate: (1,V1), (2,V2), â€¦, (N,VN),
#   where the Vi are the values in the global vector of length N.
#   The returned value is the slope of the line.
#   If the line has a single point or is vertical, it returns 1.0e20.
###
compute         msd all msd com yes
#variable        twopoint equal c_msd[4]/6/(step*dt+1.0e-6) # scaled r_sqr(t)... not used? idk what this is for...
fix             2 kr vector 5 c_msd[4]
variable        fitslope equal slope(f_2)/6/(5*dt) # why dividing slope?

thermo_style    custom step v_eqtemp c_msd[4] v_fitslope # prints this info to log file



thermo          2000
run             500000
Neighbor list info ...
  update every 1 steps, delay 10 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 16
  ghost atom cutoff = 16
  binsize = 8, bins = 4 5 4
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/newton/tri
      stencil: half/bin/3d/newton/tri
      bin: standard
WARNING: Inconsistent image flags (src/domain.cpp:785)
Per MPI rank memory allocation (min/avg/max) = 34.26 | 34.26 | 34.26 Mbytes
Step v_eqtemp c_msd[4] v_fitslope 
       0          298 1.8824207e-29 3.3333333e+18 
    2000          298 0.00012376323 1.4783015e-08 
    4000          298 3.1661652e-05 -2.3336268e-09 
    6000          298 0.00087381002 1.3006544e-08 
    8000          298 0.00026856404 6.1576222e-09 
   10000          298 0.00039868479 2.906853e-09 
   12000          298 0.0002712511 1.7007757e-09 
   14000          298 0.00054962157 4.0150109e-09 
   16000          298 0.00022177291 2.2803697e-09 
   18000          298 0.00016938217 8.3153062e-10 
   20000          298  0.000273293 4.2463707e-10 
   22000          298 0.0005298155  4.43195e-10 
   24000          298 0.0019773471 3.6715431e-09 
   26000          298  0.001766668 6.5472188e-09 
   28000          298 0.0011542099 7.8286598e-09 
   30000          298 0.0016676022 8.9060533e-09 
   32000          298 0.00059069698 8.0726738e-09 
   34000          298 0.0011101399 6.8887302e-09 
   36000          298 0.0011857238 7.3190692e-09 
   38000          298 0.0004587204 6.1979037e-09 
   40000          298 0.00038297792 4.7970477e-09 
   42000          298 0.00038955337 3.7306771e-09 
   44000          298 0.00041119228 2.9857858e-09 
   46000          298 0.00024384262 2.1967046e-09 
   48000          298 0.00040280258 1.568478e-09 
   50000          298 0.00058986418 1.173978e-09 
   52000          298 0.0018523438 1.5728734e-09 
   54000          298 0.0012317008 1.9042374e-09 
   56000          298 0.0012845072 2.3386177e-09 
   58000          298 0.0014559028 2.3357983e-09 
   60000          298 0.0012028054 2.6316975e-09 
   62000          298 0.00067868836 2.3996035e-09 
   64000          298 0.0016424965 2.361601e-09 
   66000          298 0.0016390448 2.5348806e-09 
   68000          298  0.002518901 2.8006554e-09 
   70000          298 0.0016148589 2.9829007e-09 
   72000          298 0.0015371795 3.0110098e-09 
   74000          298 0.00063547508 2.8993033e-09 
   76000          298 0.0001416096 2.5318436e-09 
   78000          298 0.00029212192 2.1268022e-09 
   80000          298 8.7366743e-05 1.7999117e-09 
   82000          298 0.00010821721 1.4917422e-09 
   84000          298 0.00081366689 1.2336173e-09 
   86000          298 9.0046042e-05 1.0428193e-09 
   88000          298 0.00021529467 8.0690744e-10 
   90000          298 0.00022792468 6.1726452e-10 
   92000          298 0.0001941746 4.3983122e-10 
   94000          298 0.00047492932 2.768583e-10 
   96000          298 0.00012307598 2.1609375e-10 
   98000          298 0.00047427426 6.6955901e-11 
  100000          298 0.00058915128 -3.5262356e-11 
  102000          298 0.00034037467 -1.3073805e-10 
  104000          298 0.00045990811 -2.2309384e-10 
  106000          298 0.00038116863 -3.0311316e-10 
  108000          298 0.00013010398 -3.634861e-10 
  110000          298 0.00022884274 -4.2831882e-10 
  112000          298 0.00023736666 -4.859749e-10 
  114000          298 0.00072181175 -4.9154547e-10 
  116000          298 0.00036945668 -5.3257253e-10 
  118000          298 0.00032479813 -5.7078263e-10 
  120000          298 0.00044281568 -5.9525602e-10 
  122000          298 8.0080485e-05 -6.1123471e-10 
  124000          298 0.0011588705 -5.8655304e-10 
  126000          298 0.00011347742 -5.9401592e-10 
  128000          298 0.0001190007 -6.1101947e-10 
  130000          298 0.00025477158 -6.190206e-10 
  132000          298 0.00030595544 -6.3823509e-10 
  134000          298 0.00034268104 -6.5714843e-10 
  136000          298 0.00029869188 -6.6617817e-10 
  138000          298 0.00036308939 -6.7413097e-10 
  140000          298 0.00012691915 -6.9087746e-10 
  142000          298 0.00043981927 -7.0637481e-10 
  144000          298 0.00031518467 -7.0658937e-10 
  146000          298 0.00056588134 -6.9901964e-10 
  148000          298 0.0001019681 -7.1202647e-10 
  150000          298 0.00025323779 -7.1706121e-10 
  152000          298 0.0001400429 -7.2637776e-10 
  154000          298 0.00025684424 -7.339388e-10 
  156000          298  0.000517882 -7.3003186e-10 
  158000          298 0.00053611437 -7.3747876e-10 
  160000          298 0.0002469732 -7.3397568e-10 
  162000          298 0.00055746599 -7.4183025e-10 
  164000          298 0.00021778814 -7.3524139e-10 
  166000          298 0.00034170843 -7.3778481e-10 
  168000          298 0.00017597206 -7.1932428e-10 
  170000          298 0.00039611737 -7.2305234e-10 
  172000          298 0.00036043971 -7.1290025e-10 
  174000          298 6.2153016e-05 -7.1966161e-10 
  176000          298 0.0005308814 -7.0311721e-10 
  178000          298 0.00027283179 -7.0025185e-10 
  180000          298 0.00013471865 -6.9593729e-10 
  182000          298 0.00020047029 -6.8674522e-10 
  184000          298 0.00024549203 -6.8039445e-10 
  186000          298 0.00011936946 -6.7149268e-10 
  188000          298 3.4698239e-05 -6.6593949e-10 
  190000          298 0.0012692647 -6.4610237e-10 
  192000          298 0.00013476359 -6.2344466e-10 
  194000          298 0.0010231846 -5.9778526e-10 
  196000          298 0.00014754534 -5.894856e-10 
  198000          298 0.00021237466 -5.7800038e-10 
  200000          298 0.0010505958 -5.5998432e-10 
  202000          298 0.0013387449 -4.883082e-10 
  204000          298  0.001868127 -4.3632828e-10 
  206000          298 0.00084440839 -3.7936166e-10 
  208000          298  0.001048677 -3.6005051e-10 
  210000          298 0.0017410846 -2.9692306e-10 
  212000          298 0.0014439328 -2.5760958e-10 
  214000          298 0.0030209743 -1.7978795e-10 
  216000          298 0.0013861833 -1.1636629e-10 
  218000          298 0.0020688643 -7.3910558e-11 
  220000          298 0.0020434082 -9.6442443e-12 
  222000          298 0.0014839783 2.8290816e-11 
  224000          298  0.001017231 6.5341674e-11 
  226000          298 0.0019950349 9.4773174e-11 
  228000          298 0.0017393535 1.2339783e-10 
  230000          298 0.0023921908 1.7109154e-10 
  232000          298 0.0015362251 2.1267531e-10 
  234000          298 0.0010109178 2.8107041e-10 
  236000          298  0.001698881 4.1116093e-10 
  238000          298 0.0013304772 6.606763e-10 
  240000          298 0.0024775741 1.3537103e-09 
  242000          298 0.0013932311 5.3018129e-09 
  244000          298 0.0020000984 -3.9270049e-09 
  246000          298 0.0020131518 -1.5993985e-09 
  248000          298 0.0011177526 -1.0605608e-09 
  250000          298 0.0014525085 -8.2760999e-10 
  252000          298  0.001548913 -6.7373052e-10 
  254000          298 0.00079293936 -5.8900222e-10 
  256000          298 0.00038415649 -4.8807113e-10 
  258000          298 0.00010120751 -4.0748318e-10 
  260000          298 0.00013858504 -3.4744965e-10 
  262000          298 0.00046230332 -3.0068852e-10 
  264000          298 0.00035192434 -2.619511e-10 
  266000          298 0.00030059288 -2.3152443e-10 
  268000          298 7.389103e-05 -2.0357292e-10 
  270000          298 0.00011134612 -1.7886271e-10 
  272000          298 0.00025036452 -1.5837598e-10 
  274000          298 3.3493699e-05 -1.4013039e-10 
  276000          298 0.0001664015 -1.2369571e-10 
  278000          298 1.4934472e-05 -1.0947886e-10 
  280000          298 0.00063483176 -9.7789861e-11 
  282000          298 0.00012278886 -8.8627958e-11 
  284000          298 0.00025459993 -7.8975365e-11 
  286000          298 0.00012519555 -7.0670941e-11 
  288000          298 0.0006959374 -6.4848608e-11 
  290000          298 0.00062703243 -5.6852427e-11 
  292000          298 0.00033906145 -5.5069895e-11 
  294000          298 0.00076210012 -4.8605495e-11 
  296000          298 0.00042751331 -4.3871863e-11 
  298000          298 0.00036581501 -3.8387943e-11 
  300000          298 0.00012035336 -3.4663758e-11 
  302000          298 0.0011306684 -3.1378251e-11 
  304000          298 0.00018708191 -2.9173267e-11 
  306000          298 0.0011902389 -2.8521658e-11 
  308000          298 0.00013678483 -2.5035469e-11 
  310000          298 0.00025484488 -2.2107619e-11 
  312000          298 0.00022155751 -1.7818437e-11 
  314000          298 0.00053723944 -1.4064716e-11 
  316000          298 0.0023983366 -1.8384413e-11 
  318000          298 0.00066909168 -2.3491912e-11 
  320000          298 0.00037905587 -2.0013988e-11 
  322000          298 0.00018232634 -1.6061252e-11 
  324000          298 0.00043136049 -1.3693449e-11 
  326000          298 0.00052220531 -9.5262429e-12 
  328000          298 0.00044389527 -5.8441974e-12 
  330000          298 0.00017681317 -2.4304814e-12 
  332000          298 0.0005895172 8.7828052e-13 
  334000          298 0.0002339503 1.1514327e-12 
  336000          298 0.00021031769  4.10564e-12 
  338000          298 0.00013152701 6.8145103e-12 
  340000          298 0.00025442958 9.0290792e-12 
  342000          298 0.00017141584 1.1835725e-11 
  344000          298 0.00011827051 1.4618902e-11 
  346000          298 0.00026012889 1.6990751e-11 
  348000          298 4.4548474e-05 1.9838917e-11 
  350000          298 0.00023932698 2.2509539e-11 
  352000          298 0.00039897261 2.4584301e-11 
  354000          298 0.0004026484 2.7055866e-11 
  356000          298 0.00040421514 2.6258756e-11 
  358000          298 0.0002480849 2.8385809e-11 
  360000          298 0.00037651938 3.0387266e-11 
  362000          298 0.00083672838 3.1704438e-11 
  364000          298 0.00037626103 3.2519377e-11 
  366000          298 0.00065720063 3.3187117e-11 
  368000          298 0.0003120006 3.4719572e-11 
  370000          298 0.00044980684 3.6198575e-11 
  372000          298 0.00047874704 3.7825656e-11 
  374000          298 7.7016041e-05 3.843494e-11 
  376000          298 0.00025454588 4.0306041e-11 
  378000          298 0.0001580422 4.1810753e-11 
  380000          298 0.00019285605 4.332449e-11 
  382000          298 0.00051065762 4.5016164e-11 
  384000          298 0.00022793524 4.3933944e-11 
  386000          298 0.00045085737 4.5645975e-11 
  388000          298 0.00031999511 4.6816014e-11 
  390000          298 0.00044894532 4.817501e-11 
  392000          298 0.0003196087 4.9700697e-11 
  394000          298 0.0006686936 4.9295072e-11 
  396000          298 0.00027471277 5.1087457e-11 
  398000          298 0.00053273651 5.2393388e-11 
  400000          298 0.00049442969 5.3794444e-11 
  402000          298 0.00028611206 5.5591872e-11 
  404000          298 0.00015663233 5.4592711e-11 
  406000          298 0.0010659435 5.4142777e-11 
  408000          298 0.00023969975 5.2652529e-11 
  410000          298 0.0013445519 -5.312802e-11 
  412000          298 8.4031837e-05 -5.5366432e-11 
  414000          298 0.00053605939 -5.7958726e-11 
  416000          298 0.00055502947 -6.2560773e-11 
  418000          298 0.00034945721 -6.3966878e-11 
  420000          298 0.00043199774 -6.9242317e-11 
  422000          298 0.00059348584 -7.4242781e-11 
  424000          298 0.0012139156 -7.6933976e-11 
  426000          298 0.0015209197 -7.2695999e-11 
  428000          298 0.0018359519 -6.856193e-11 
  430000          298 0.00097926487 -6.5430686e-11 
  432000          298  0.001325092 -6.6960984e-11 
  434000          298 0.0015620028 -6.0873537e-11 
  436000          298 0.00027894239 -6.4253669e-11 
  438000          298 0.00021444855 -7.1570288e-11 
  440000          298 0.00023841456 -8.0075225e-11 
  442000          298 0.00032690562 -9.04078e-11 
  444000          298 3.635471e-05 -1.0167074e-10 
  446000          298 0.00014341259 -1.1627738e-10 
  448000          298 7.2088185e-05 -1.3262896e-10 
  450000          298  1.94505e-05 -1.5300385e-10 
  452000          298 0.00064219604 -1.7530363e-10 
  454000          298 0.00030641266 -2.0207608e-10 
  456000          298 0.00046300949 -2.2670096e-10 
  458000          298 0.00045052865 -2.7137978e-10 
  460000          298 0.00028262696 -3.1936224e-10 
  462000          298 0.00082413955 -4.0023857e-10 
  464000          298 6.0728372e-05 -5.2637309e-10 
  466000          298 0.00033853943 -7.549089e-10 
  468000          298 0.0016302757 -1.2419286e-09 
  470000          298 0.0014495719 -3.2612825e-09 
  472000          298  0.002093152 3.193355e-09 
  474000          298 0.0015861287 9.1377577e-10 
  476000          298 0.0010593386 4.5716648e-10 
  478000          298 0.0013148064 3.046506e-10 
  480000          298 0.00094899769 1.923159e-10 
  482000          298 0.0017691876 1.3950265e-10 
  484000          298 0.00079880808 8.9745345e-11 
  486000          298 0.0013164043 7.1261485e-11 
  488000          298 0.0012453731 3.8043017e-11 
  490000          298 0.0020891801 1.7696762e-11 
  492000          298 0.0014060895 -7.650485e-13 
  494000          298 0.0015004716 -1.8653491e-11 
  496000          298 0.00052888225 -1.9751125e-11 
  498000          298 0.00031973044 -1.3919472e-11 
  500000          298 7.4167827e-05 -7.009807e-12 
Loop time of 385.763 on 1 procs for 500000 steps with 2233 atoms

Performance: 111.986 ns/day, 0.214 hours/ns, 1296.132 timesteps/s
100.0% CPU use with 1 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 9.2508     | 9.2508     | 9.2508     |   0.0 |  2.40
Bond    | 326.99     | 326.99     | 326.99     |   0.0 | 84.76
Neigh   | 5.4642     | 5.4642     | 5.4642     |   0.0 |  1.42
Comm    | 27.968     | 27.968     | 27.968     |   0.0 |  7.25
Output  | 0.31845    | 0.31845    | 0.31845    |   0.0 |  0.08
Modify  | 7.0863     | 7.0863     | 7.0863     |   0.0 |  1.84
Other   |            | 8.69       |            |       |  2.25

Nlocal:    2233 ave 2233 max 2233 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    15409 ave 15409 max 15409 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    1197 ave 1197 max 1197 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 1197
Ave neighs/atom = 0.53605
Ave special neighs/atom = 6.38424
Neighbor list builds = 100
Dangerous builds = 0
unfix           1
unfix           2
undump          Pn_Ni-PyC-NH2_with_Kr_xyzmov


Total wall time: 0:06:25
